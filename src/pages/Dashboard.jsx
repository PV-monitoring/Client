import { useState } from "react";
import { Box, Button, IconButton, Typography, useTheme } from "@mui/material";
import { tokens } from "../theme";
import { mockTransactions } from "../data/mockData";
import DownloadOutlinedIcon from "@mui/icons-material/DownloadOutlined";
import Header from "../components/Header";
import LineChart from "../components/LineChart";
import GeographyChart from "../components/GeographyChart";
import StatBox from "../components/StatBox";
import ProgressCircle from "../components/ProgressCircle";
import BarChart from "../components/Barchart";
import SolarPowerIcon from "@mui/icons-material/SolarPower";
import OfflineBoltIcon from "@mui/icons-material/OfflineBolt";
import AddBoxIcon from "@mui/icons-material/AddBox";
import PaidIcon from "@mui/icons-material/Paid";
import Topbar from "./global/Topbar";
import Sidebar from "./global/Sidebar";
import { CssBaseline, ThemeProvider } from "@mui/material";
import { ColorModeContext, useMode } from "../theme";

const Dashboard = () => {
  const [theme, colorMode] = useMode();
  const [isSidebar, setIsSidebar] = useState(true);
  const colors = tokens(theme.palette.mode);

  return (
    <ColorModeContext.Provider value={colorMode}>
      <ThemeProvider theme={theme}>
        <CssBaseline />
        <div className="app">
          <Sidebar isSidebar={isSidebar} />
          <main className="content">
            <Topbar setIsSidebar={setIsSidebar} />
   
            <Box m="20px">
              {/* HEADER */}
              <Box display="flex" justifyContent="space-between" alignItems="center">
                <Header title="DASHBOARD" subtitle="Welcome to Green Energy Dashboard" />
                <Box>
                  <Button
                    sx={{
                      backgroundColor: colors.blueAccent[700],
                      color: colors.grey[100],
                      fontSize: "14px",
                      fontWeight: "bold",
                      padding: "10px 20px",
                    }}>
                    <DownloadOutlinedIcon sx={{ mr: "10px" }} />
                    Download Reports
                  </Button>
                </Box>
              </Box>

              {/* GRID & CHARTS */}

              <Box
                display="grid "
                gridTemplateColumns="repeat(12, 1fr)"
                gridAutoRows="140px"
                gap="20px">
                {/* ROW 1 */}
                <Box
                  gridColumn="span 3"
                  backgroundColor={colors.primary[400]}
                  display="flex"
                  alignItems="center"
                  justifyContent="center">
                  <StatBox
                    title="2,361"
                    subtitle="Total Working Plants"
                    progress="0.75"
                    increase="75%"
                    icon={
                      <SolarPowerIcon sx={{ color: colors.greenAccent[600], fontSize: "26px" }} />
                    }
                  />
                </Box>
                <Box
                  gridColumn="span 3"
                  backgroundColor={colors.primary[400]}
                  display="flex"
                  alignItems="center"
                  justifyContent="center">
                  <StatBox
                    title="1,225kW"
                    subtitle="Current Working Capacity"
                    progress="0.50"
                    increase="80%"
                    icon={
                      <OfflineBoltIcon sx={{ color: colors.greenAccent[600], fontSize: "26px" }} />
                    }
                  />
                </Box>
                <Box
                  gridColumn="span 3"
                  backgroundColor={colors.primary[400]}
                  display="flex"
                  alignItems="center"
                  justifyContent="center">
                  <StatBox
                    title="7"
                    subtitle="New Plants this Month"
                    progress="0.30"
                    increase="+2%"
                    icon={<AddBoxIcon sx={{ color: colors.greenAccent[600], fontSize: "26px" }} />}
                  />
                </Box>
                <Box
                  gridColumn="span 3"
                  backgroundColor={colors.primary[400]}
                  display="flex"
                  alignItems="center"
                  justifyContent="center">
                  <StatBox
                    title="$ 1,325,134"
                    subtitle="Total Income this Month"
                    progress="0.80"
                    increase="+13%"
                    icon={<PaidIcon sx={{ color: colors.greenAccent[600], fontSize: "26px" }} />}
                  />
                </Box>

                {/* ROW 2 */}
                <Box gridColumn="span 8" gridRow="span 2" backgroundColor={colors.primary[400]}>
                  <Box
                    mt="25px"
                    p="0 30px"
                    display="flex "
                    justifyContent="space-between"
                    alignItems="center">
                    <Box>
                      <Typography variant="h5" fontWeight="600" color={colors.grey[100]}>
                        Revenue Generated
                      </Typography>
                      <Typography variant="h3" fontWeight="bold" color={colors.greenAccent[500]}>
                        $50,300.00
                      </Typography>
                    </Box>
                    <Box>
                      <IconButton>
                        <DownloadOutlinedIcon
                          sx={{ fontSize: "26px", color: colors.greenAccent[500] }}
                        />
                      </IconButton>
                    </Box>
                  </Box>
                  <Box height="250px" m="-20px 0 0 0">
                    <LineChart isDashboard={true} />
                  </Box>
                </Box>
                <Box
                  gridColumn="span 4"
                  gridRow="span 2"
                  backgroundColor={colors.primary[400]}
                  overflow="auto">
                  <Box
                    display="flex"
                    justifyContent="space-between"
                    alignItems="center"
                    borderBottom={`4px solid ${colors.primary[500]}`}
                    colors={colors.grey[100]}
                    p="15px">
                    <Typography color={colors.grey[100]} variant="h5" fontWeight="600">
                      Alarms
                    </Typography>
                  </Box>
                  {mockTransactions.map((transaction, i) => (
                    <Box
                      key={`${transaction.plantId}-${i}`}
                      display="flex"
                      justifyContent="space-between"
                      alignItems="center"
                      borderBottom={`4px solid ${colors.primary[500]}`}
                      p="15px">
                      <Box>
                        <Typography color={colors.greenAccent[500]} variant="h5" fontWeight="600">
                          {transaction.plantId}
                        </Typography>
                        <Typography color={colors.grey[100]}>{transaction.plant}</Typography>
                      </Box>
                      <Box color={colors.grey[100]}>{transaction.date}</Box>
                      <Box backgroundColor={colors.redAccent[500]} p="5px 10px" borderRadius="4px">
                        {transaction.fault}
                      </Box>
                    </Box>
                  ))}
                </Box>

                {/* ROW 3 */}
                <Box
                  gridColumn="span 4"
                  gridRow="span 2"
                  backgroundColor={colors.primary[400]}
                  p="30px">
                  <Typography variant="h5" fontWeight="600">
                    Plant Classification
                  </Typography>
                  <Box display="flex" flexDirection="column" alignItems="center" mt="25px">
                    <ProgressCircle size="125" />
                    <Typography
                      variant="h5"
                      color={colors.greenAccent[500]}
                      display="flex"
                      // sx={{ mt: "15px" }}
                    >
                      Commercial Rooftop
                    </Typography>
                    <Typography
                      variant="h5"
                      color={colors.blueAccent[500]}
                      display="flex"
                      // sx={{ mt: "15px" }}
                    >
                      Residentail
                    </Typography>
                  </Box>
                </Box>
                <Box gridColumn="span 4" gridRow="span 2" backgroundColor={colors.primary[400]}>
                  <Typography variant="h5" fontWeight="600" sx={{ padding: "30px 30px 0 30px" }}>
                    Generation of Last 7 Months (kWh)
                  </Typography>
                  <Box height="250px" mt="-20px">
                    <BarChart isDashboard={true} />
                  </Box>
                </Box>
                <Box
                  gridColumn="span 4"
                  gridRow="span 2"
                  backgroundColor={colors.primary[400]}
                  padding="30px">
                  <Typography variant="h5" fontWeight="600" sx={{ marginBottom: "15px" }}>
                    Plants Geography
                  </Typography>
                  <Box height="200px">
                    <GeographyChart isDashboard={true} />
                  </Box>
                </Box>
              </Box>
            </Box>
            </main>
        </div>
      </ThemeProvider>
    </ColorModeContext.Provider>
  );
};

export default Dashboard;
